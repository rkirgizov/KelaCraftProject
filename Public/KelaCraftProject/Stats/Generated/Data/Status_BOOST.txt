// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// Алхимия
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------

new entry "KELA_LABORATORY_AURA"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "KELA_LABORATORY_AURA"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"
data "AuraRadius" "10"
data "AuraStatuses" "TARGET:IF(Character() and AbilityGreaterThan('Intelligence',12)):ApplyStatus(KELA_LABORATORY_AURA_ACTIVE)"

new entry "KELA_LABORATORY_AURA_ACTIVE"
type "StatusData"
data "StatusType" "BOOST"
data "Icon" "Item_LOOT_Laboratory_Flask_Glass_F_Empty_A"
data "DisplayName" "hde737bfb31a14f60a0895cc0683c1c31c8fc;1"
data "Description" "hd3b46269c355406fa1efb3e043909a89gd2d;1"
data "StackId" "KELA_LABORATORY_AURA_ACTIVE"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog"

// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// УЛУЧШЕНИЕ ОРУЖИЯ
// Режущее и колющее (точильный камень с обычным оружейным маслом):
//   обычный уровень - любой персонаж
//   выше - Кузнец, прочитавший наставления
// Стрелковое (ремесленный стол с обычным оружейным маслом):
//   обычный уровень - персонаж с предысторией Ремесленник, эльф, дроу или Кузнец
//   выше - Кузнец с предысторий Ремесленник, прочитавший наставления
// Ударное (наковальня с обычным оружейным маслом):
//   обычный уровень - кузнец, не прочитавший наставления
//   выше - кузнец, прочитавший наставления
// Всё оружие:
//  закалка/пропитка в ведре с оружейным маслом, имеющим дополнительные свойства
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------

// ------------------------------------------------------------------------
// Подготовка точильного камня / наковальни / ремесленного стола
// Через заклинание Target_Use_Weapon_Oil_Simple
// ------------------------------------------------------------------------
new entry "KELA_WEAPON_OIL_USED_SIMPLE"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "ForceOverhead"
data "DisplayName" "h13a5791cg5ed8g40cfga717g39d7283f398f;1"
data "Description" "h9ce93eefgd3d7g4d70g8050g40dd88e04c85;1"
data "Icon" "Item_CONS_Potion_Grinding_Oil_A"
data "StackId" "KELA_WEAPON_OIL_USED_SIMPLE"

// ------------------------------------------------------------------------
// Подготовка ведра
// Через заклинание Target_Use_Weapon_Oil_
// ------------------------------------------------------------------------
new entry "KELA_WEAPON_OIL_USED_SUSSUR"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "ForceOverhead"
data "DisplayName" "h978bffa6g12f7g4051ga9a4g081b6c881fcb;1"
data "Description" "h87cab18age3a8g4df2ga923gf0371e9e7a5d;1"
data "DescriptionParams" "13;2"
data "Icon" "Item_CONS_Potion_Sussur_Oil_A"
data "StackId" "KELA_WEAPON_OIL_USED_SUSSUR"

// ------------------------------------------------------------------------
// Уменьшение длительности действия оружейного масла
// ------------------------------------------------------------------------
new entry "KELA_WEAPON_OIL_USED_REDUCE"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisablePortraitIndicator;DisableCombatlog"
data "StackId" "KELA_WEAPON_OIL_USED_REDUCE"
data "OnApplyFunctors" "IF(HasStatus('KELA_WEAPON_OIL_USED_SIMPLE')):SetStatusDuration(KELA_WEAPON_OIL_USED_SIMPLE,-3,Add);IF(HasStatus('KELA_WEAPON_OIL_USED_SUSSUR')):SetStatusDuration(KELA_WEAPON_OIL_USED_SUSSUR,-3,Add)"

// ------------------------------------------------------------------------
// Оружие обработано (общий технический признак)
// ------------------------------------------------------------------------
new entry "KELA_WEAPON_UPGRADED"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisablePortraitIndicator;DisableOverhead;DisableCombatlog;IgnoreResting"
data "Icon" "Tooltip_Weapon_Upgraded"
data "StackId" "KELA_WEAPON_UPGRADED" 

// ------------------------------------------------------------------------
// Снятие дополнительной обработки
// ------------------------------------------------------------------------
new entry "KELA_WEAPON_UPGRADED_NEED_REMOVE"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "KELA_WEAPON_UPGRADED_NEED_REMOVE"
data "StatusPropertyFlags" "DisablePortraitIndicator;DisableCombatlog"
data "AuraRadius" "3"
data "AuraStatuses" "TARGET:IF(Item() and (Tagged('KELAWHETSTONE') or Tagged('KELAANVIL') or Tagged('WORKBENCH'))):ApplyStatus(KELA_WEAPON_OIL_USED_REDUCE,100,0)"
data "OnApplyFunctors" "ApplyEquipmentStatus(MainHand, KELA_WEAPON_UPGRADED_REMOVE, 100, 0)"

new entry "KELA_WEAPON_UPGRADED_REMOVE"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisablePortraitIndicator;ForceOverhead"
data "DisplayName" "hbd9aac50f3aa408888dff0ebfd2ed6329625;1"
data "Description" "h7496479c73ed4a449e6e9232fac3b1a57079;1"
data "StackId" "KELA_WEAPON_UPGRADED_REMOVE"
data "OnApplyFunctors" "RemoveStatus(KELA_WEAPON_UPGRADED);RemoveStatus(KELA_WEAPON_UPGRADED_SIMPLE);RemoveStatus(KELA_WEAPON_UPGRADED_PROFI);RemoveStatus(KELA_WEAPON_UPGRADED_EXPERT);RemoveStatus(KELA_WEAPON_UPGRADED_MASTER);RemoveStatus(KELA_WEAPON_UPGRADED_BAD);RemoveStatus(KELA_GUILD_ARTISAN_BONUS)"

// ------------------------------------------------------------------------
// Дополнительная обработка
// ------------------------------------------------------------------------

// Распределяем по уровню
new entry "KELA_WEAPON_UPGRADE_BY_LEVEL"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "KELA_WEAPON_UPGRADE_BY_LEVEL"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"
data "AuraRadius" "3"
data "AuraStatuses" "TARGET:IF(Item() and (Tagged('KELAWHETSTONE') or Tagged('KELAANVIL') or Tagged('WORKBENCH'))):ApplyStatus(KELA_WEAPON_OIL_USED_REDUCE,100,0)"
data "OnApplyFunctors" "IF(not HasPassive('PassiveFeature_KelaBlacksmith', context.Source) and not Tagged('KELABLACKSMITHINGAPPRENTICE', context.Source) and not Tagged('KELABLACKSMITHINGEXPERT', context.Source) and not Tagged('KELABLACKSMITHINGMASTER', context.Source)):ApplyStatus(KELA_WEAPON_UPGRADE_OIL_15,100,0);IF(HasPassive('PassiveFeature_KelaBlacksmith', context.Source) and not Tagged('KELABLACKSMITHINGAPPRENTICE', context.Source) and not Tagged('KELABLACKSMITHINGEXPERT', context.Source) and not Tagged('KELABLACKSMITHINGMASTER', context.Source)):ApplyStatus(KELA_WEAPON_UPGRADE_OIL_12,100,0);IF(Tagged('KELABLACKSMITHINGAPPRENTICE', context.Source)):ApplyStatus(KELA_WEAPON_UPGRADE_OIL_10,100,0);IF(Tagged('KELABLACKSMITHINGEXPERT', context.Source)):ApplyStatus(KELA_WEAPON_UPGRADE_OIL_8,100,0);IF(Tagged('KELABLACKSMITHINGMASTER', context.Source)):ApplyStatus(KELA_WEAPON_UPGRADE_OIL_6,100,0)"

// Заточка без масла: только обычная заточка
new entry "KELA_WEAPON_UPGRADE_WITHOUT_OIL_18"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hbd846f350c62433cb60c39a7096b9bffc0cf;1"
data "Description" "h2edb5a6d04ef49b7bc87b66c144e18136dc0;1"
data "DescriptionParams" "18"
data "StackId" "KELA_WEAPON_UPGRADE_WITHOUT_OIL_18"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"
data "TooltipSave" "Dexterity"
data "OnApplyRoll" "SavingThrow(Ability.Dexterity, 18)"
data "OnApplySuccess" "ApplyEquipmentStatus(MainHand, KELA_WEAPON_UPGRADED_SIMPLE, 100, -1)"
data "OnApplyFail" "ApplyEquipmentStatus(MainHand, KELA_WEAPON_UPGRADED_BAD, 100, -1)"

// Нет черты Кузнец: только обычная заточка
new entry "KELA_WEAPON_UPGRADE_OIL_15"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hcb8942598a104da7a820fef39ee582e9ef94;1"
data "Description" "h2edb5a6d04ef49b7bc87b66c144e18136dc0;1"
data "DescriptionParams" "15"
data "StackId" "KELA_WEAPON_UPGRADE_OIL_15"
// data "StatusPropertyFlags" "ForceOverhead;DisablePortraitIndicator"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"
data "TooltipSave" "Dexterity"
data "OnApplyRoll" "SavingThrow(Ability.Dexterity, 15)"
data "OnApplySuccess" "ApplyEquipmentStatus(MainHand, KELA_WEAPON_UPGRADED_SIMPLE, 100, -1)"
data "OnApplyFail" "ApplyEquipmentStatus(MainHand, KELA_WEAPON_UPGRADED_BAD, 100, -1)"

// Есть черта Кузнец, но не читал книги: только обычная заточка
new entry "KELA_WEAPON_UPGRADE_OIL_12"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hdb9238c947b14cf485bbda4cfbea8c8850ag;1"
data "Description" "h2edb5a6d04ef49b7bc87b66c144e18136dc0;1"
data "DescriptionParams" "12"
data "StackId" "KELA_WEAPON_UPGRADE_OIL_12"
// data "StatusPropertyFlags" "ForceOverhead;DisablePortraitIndicator"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"
data "TooltipSave" "Dexterity"
data "OnApplyRoll" "SavingThrow(Ability.Dexterity, 12)"
data "OnApplySuccess" "ApplyEquipmentStatus(MainHand, KELA_WEAPON_UPGRADED_SIMPLE, 100, -1)"
data "OnApplyFail" "ApplyEquipmentStatus(MainHand, KELA_WEAPON_UPGRADED_BAD, 100, -1)"

// Кузнец-подмастерье: обычная и профи заточка 
new entry "KELA_WEAPON_UPGRADE_OIL_10"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h69a45e5b996d4a2cab1f19636db79a45244f;1"
data "Description" "h2edb5a6d04ef49b7bc87b66c144e18136dc0;1"
data "DescriptionParams" "10"
data "StackId" "KELA_WEAPON_UPGRADE_OIL_10"
// data "StatusPropertyFlags" "ForceOverhead;DisablePortraitIndicator"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"
data "TooltipSave" "Dexterity"
data "OnApplyRoll" "SavingThrow(Ability.Dexterity, 10)"
data "OnApplySuccess" "IF(IsProficientWith(context.Target, GetActiveWeapon(context.Target, true))):ApplyEquipmentStatus(MainHand, KELA_WEAPON_UPGRADED_PROFI, 100, -1);IF(not IsProficientWith(context.Target, GetActiveWeapon(context.Target, true))):ApplyEquipmentStatus(MainHand, KELA_WEAPON_UPGRADED_SIMPLE, 100, -1)"
data "OnApplyFail" "ApplyEquipmentStatus(MainHand, KELA_WEAPON_UPGRADED_BAD, 100, -1)"

// Кузнец-эксперт: профи и экспертная заточка 
new entry "KELA_WEAPON_UPGRADE_OIL_8"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h8f3f0277378841648635781bdfa021ae7943;1"
data "Description" "h2edb5a6d04ef49b7bc87b66c144e18136dc0;1"
data "DescriptionParams" "8"
data "StackId" "KELA_WEAPON_UPGRADE_OIL_8"
// data "StatusPropertyFlags" "ForceOverhead;DisablePortraitIndicator"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"
data "TooltipSave" "Dexterity"
data "OnApplyRoll" "SavingThrow(Ability.Dexterity, 8)"
data "OnApplySuccess" "IF(IsProficientWith(context.Target, GetActiveWeapon(context.Target, true))):ApplyEquipmentStatus(MainHand, KELA_WEAPON_UPGRADED_EXPERT, 100, -1);IF(not IsProficientWith(context.Target, GetActiveWeapon(context.Target, true))):ApplyEquipmentStatus(MainHand, KELA_WEAPON_UPGRADED_PROFI, 100, -1)"
data "OnApplyFail" "ApplyEquipmentStatus(MainHand, KELA_WEAPON_UPGRADED_BAD, 100, -1)"

//Кузнец-мастер: экспертная и мастерская заточка 
new entry "KELA_WEAPON_UPGRADE_OIL_6"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hf73888f2daaf47fca1fbe4976dad96fcebb8;1"
data "Description" "h2edb5a6d04ef49b7bc87b66c144e18136dc0;1"
data "DescriptionParams" "6"
data "StackId" "KELA_WEAPON_UPGRADE_OIL_6"
// data "StatusPropertyFlags" "ForceOverhead;DisablePortraitIndicator"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"
data "TooltipSave" "Dexterity"
data "OnApplyRoll" "SavingThrow(Ability.Dexterity, 6)"
data "OnApplySuccess" "IF(IsProficientWith(context.Target, GetActiveWeapon(context.Target, true))):ApplyEquipmentStatus(MainHand, KELA_WEAPON_UPGRADED_MASTER, 100, -1);IF(not IsProficientWith(context.Target, GetActiveWeapon(context.Target, true))):ApplyEquipmentStatus(MainHand, KELA_WEAPON_UPGRADED_EXPERT, 100, -1)"
data "OnApplyFail" "ApplyEquipmentStatus(MainHand, KELA_WEAPON_UPGRADED_BAD, 100, -1)"

new entry "KELA_WEAPON_UPGRADED_SIMPLE"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "KELA_WEAPON_UPGRADED_SIMPLE"
data "StatusPropertyFlags" "DisableOverhead;IgnoreResting"
data "Icon" "Tooltip_Sharpenning_Good"
data "DisplayName" "h6cf3c6dega908g4c6dgb909gea6fcba7bccf;1"
data "Description" "hb72b0aa6e7a746108e5e2f0d83d511dbcde7;1"
data "DescriptionParams" "1"
data "TooltipDamage" "DealDamage(1, Piercing)"
data "Boosts" "IF(IsDamageTypeSlashing()):WeaponDamage(1,Slashing);IF(IsDamageTypePiercing()):WeaponDamage(1,Piercing);IF(IsDamageTypeBludgeoning()):WeaponDamage(1,Bludgeoning)"
data "OnApplyFunctors" "ApplyStatus(KELA_WEAPON_UPGRADED,100,-1);IF(HasPassive('PassiveFeature_KelaBlacksmith', GetOwner(context.Target))):ApplyStatus(KELA_GUILD_ARTISAN_BONUS, 100, -1)"

new entry "KELA_WEAPON_UPGRADED_PROFI"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;IgnoreResting"
data "StackId" "KELA_WEAPON_UPGRADED_PROFI"
data "Icon" "Tooltip_Sharpenning_Good"
data "DisplayName" "h2cb13dd1g7ac7g48c5gb9b7ga9f99cca1fdc;1"
data "Description" "hb72b0aa6e7a746108e5e2f0d83d511dbcde7;1"
data "DescriptionParams" "2"
data "TooltipDamage" "DealDamage(2, Piercing)"
data "Boosts" "IF(IsDamageTypeSlashing()):WeaponDamage(2,Slashing);IF(IsDamageTypePiercing()):WeaponDamage(2,Piercing);IF(IsDamageTypeBludgeoning()):WeaponDamage(2,Bludgeoning)"
data "OnApplyFunctors" "ApplyStatus(KELA_WEAPON_UPGRADED,100,-1);IF(HasPassive('PassiveFeature_KelaBlacksmith', GetOwner(context.Target))):ApplyStatus(KELA_GUILD_ARTISAN_BONUS, 100, -1)"

new entry "KELA_WEAPON_UPGRADED_EXPERT"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;IgnoreResting"
data "StackId" "KELA_WEAPON_UPGRADED_EXPERT"
data "Icon" "Tooltip_Sharpenning_Good"
data "DisplayName" "h8a4f8163f36a401bbec606e775643dd13f85;1"
data "Description" "hacd9e5c1g7238g46c8gae66gabaf8658d06b;1"
data "DescriptionParams" "1;3"
data "TooltipDamage" "DealDamage(3, Piercing)"
data "Boosts" "WeaponAttackRollBonus(1);IF(IsDamageTypeSlashing()):WeaponDamage(3,Slashing);IF(IsDamageTypePiercing()):WeaponDamage(3,Piercing);IF(IsDamageTypeBludgeoning()):WeaponDamage(3,Bludgeoning)"
data "OnApplyFunctors" "ApplyStatus(KELA_WEAPON_UPGRADED,100,-1);IF(HasPassive('PassiveFeature_KelaBlacksmith', GetOwner(context.Target))):ApplyStatus(KELA_GUILD_ARTISAN_BONUS, 100, -1)"

new entry "KELA_WEAPON_UPGRADED_MASTER"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;IgnoreResting"
data "StackId" "KELA_WEAPON_UPGRADED_MASTER"
data "Icon" "Tooltip_Sharpenning_Good"
data "DisplayName" "h3d83d383e8c2408792da46543d2d3eee3062;1"
data "Description" "hacd9e5c1g7238g46c8gae66gabaf8658d06b;1"
data "DescriptionParams" "2;3"
data "TooltipDamage" "DealDamage(3, Piercing)"
data "Boosts" "WeaponAttackRollBonus(2);IF(IsDamageTypeSlashing()):WeaponDamage(3,Slashing);IF(IsDamageTypePiercing()):WeaponDamage(3,Piercing);IF(IsDamageTypeBludgeoning()):WeaponDamage(3,Bludgeoning)"
data "OnApplyFunctors" "ApplyStatus(KELA_WEAPON_UPGRADED,100,-1);IF(HasPassive('PassiveFeature_KelaBlacksmith', GetOwner(context.Target))):ApplyStatus(KELA_GUILD_ARTISAN_BONUS, 100, -1)"

new entry "KELA_WEAPON_UPGRADED_BAD"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;IgnoreResting"
data "StackId" "KELA_WEAPON_UPGRADED_BAD"
data "Icon" "Tooltip_Sharpenning_Bad"
data "DisplayName" "hb2283b71ge6a9g4e5fgbf3bgc598893ccd13;1"
data "Description" "h9f5e4109898742728840ab7cf7d07a25d477;1"
data "DescriptionParams" "-2;-2"
data "TooltipDamage" "DealDamage(-2, Piercing)"
data "Boosts" "WeaponAttackRollBonus(-2);IF(IsDamageTypeSlashing()):WeaponDamage(-2,Slashing);IF(IsDamageTypePiercing()):WeaponDamage(-2,Piercing);IF(IsDamageTypeBludgeoning()):WeaponDamage(-2,Bludgeoning)"
data "OnApplyFunctors" "ApplyStatus(KELA_WEAPON_UPGRADED,100,-1)"

new entry "KELA_GUILD_ARTISAN_BONUS"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h870ca004dd7141b5ad33d8f889500a6a0ad0;1"
data "Description" "h11f3882be1c6455187e2ea7cd83be7db7935;1"
data "DescriptionParams" "1"
data "StatusPropertyFlags" "DisableOverhead;IgnoreResting"
data "Icon" "Item_CONS_Potion_Sussur_Oil_A"
data "Boosts" "WeaponAttackRollBonus(1)"
data "StackId" "KELA_GUILD_ARTISAN_BONUS"

// ------------------------------------------------------------------------
// Закалка/пропитка маслом с суссуром
// ------------------------------------------------------------------------
// Распределяем по уровню
new entry "KELA_WEAPON_TEMPER_BY_LEVEL"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "KELA_WEAPON_TEMPER_BY_LEVEL"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"
data "AuraRadius" "3"
data "AuraStatuses" "TARGET:IF(Item() and Tagged('BUCKET')):ApplyStatus(KELA_WEAPON_OIL_USED_REDUCE,100,0)"
data "OnApplyFunctors" "IF(not HasPassive('PassiveFeature_KelaBlacksmith', context.Source) and not Tagged('KELABLACKSMITHINGAPPRENTICE', context.Source) and not Tagged('KELABLACKSMITHINGEXPERT', context.Source) and not Tagged('KELABLACKSMITHINGMASTER', context.Source)):ApplyEquipmentStatus(MainHand, KELA_SUSSUR_OIL_DIPPED, 100, 25);IF(HasPassive('PassiveFeature_KelaBlacksmith', context.Source) and not Tagged('KELABLACKSMITHINGAPPRENTICE', context.Source) and not Tagged('KELABLACKSMITHINGEXPERT', context.Source) and not Tagged('KELABLACKSMITHINGMASTER', context.Source)):ApplyEquipmentStatus(MainHand, KELA_SUSSUR_OIL_DIPPED, 100, 50);IF(Tagged('KELABLACKSMITHINGAPPRENTICE', context.Source)):ApplyEquipmentStatus(MainHand, KELA_SUSSUR_OIL_DIPPED, 100, 150);IF(Tagged('KELABLACKSMITHINGEXPERT', context.Source)):ApplyEquipmentStatus(MainHand, KELA_SUSSUR_OIL_DIPPED, 100, 400);IF(Tagged('KELABLACKSMITHINGMASTER', context.Source)):ApplyEquipmentStatus(MainHand, KELA_SUSSUR_OIL_DIPPED, 100, 1000)"

// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// Масло суссура
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------

new entry "KELA_SUSSUR_OIL"
type "StatusData"
data "StatusType" "BOOST"
using "WEAPON_COATED_WITH_POISON"
data "DisplayName" "h31737c72fb2149d0b1d2d8c54d9ec586499d;1"
data "Description" "hd501a488ffcd4eebbe6a0756c981c4bd3a15;1"
data "DescriptionParams" "10;13;2"
data "Icon" "Item_CONS_Potion_Sussur_Oil_A"
data "StackId" "KELA_SUSSUR_OIL"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"
data "OnApplyFunctors" "AI_IGNORE:IF(WieldingWeapon('Dippable') and not WieldingWeapon('Torch')):ApplyEquipmentStatus(MainHand,KELA_SUSSUR_OIL_DIPPED,100,10);AI_IGNORE:IF(WieldingWeapon('Dippable',true) and not WieldingWeapon('Torch',true)):ApplyEquipmentStatus(OffHand,KELA_SUSSUR_OIL_DIPPED,100,10);AI_ONLY:IF(not HasStatus('DIPPED_FIRE',GetActiveWeapon())):ApplyStatus(SELF,AI_HELPER_SUSSUR_OIL_DIPPED,100,0)"

new entry "KELA_SUSSUR_OIL_DIPPED"
type "StatusData"
data "StatusType" "BOOST"
using "DIPPED_POISON"
data "DisplayName" "h31737c72fb2149d0b1d2d8c54d9ec586499d;1"
data "Description" "h76d39435gfe13g4a54ga0c0g9c3c6f2169ce;1"
data "DescriptionParams" "2;13"
data "Icon" "Item_CONS_Potion_Sussur_Oil_A"
data "StatusEffectOverride" ""
data "Boosts" ""
data "Passives" "KELA_Sussur_Oil_Passive"
data "StackId" "KELA_SUSSUR_OIL_DIPPED"

new entry "AI_HELPER_SUSSUR_OIL_DIPPED"
type "StatusData"
data "StatusType" "BOOST"
using "AI_HELPERS"
data "OnApplyFunctors" "AI_ONLY:IF(not HasStatus('KELA_SUSSUR_OIL_DIPPED',GetActiveWeapon()) and not HasStatus('DIPPED_FIRE',GetActiveWeapon())):ApplyStatus(SELF,KELA_SUSSUR_OIL_DIPPED,100,10)"

// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// Готовность наковальни (плавильня горит)
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------

new entry "KELA_SMELTINGFORGE_STATUS_STAGE_1"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "KELA_SMELTINGFORGE_STATUS_STAGE_1"
data "DisplayName" "h6c3aefd2g3755g43c6gb316g62d263501dc9;1"
data "Description" "h2fc48659g0959g4b97g845agea24e7781a09;1"
data "StatusPropertyFlags" "DisableOverhead;IgnoreResting"
data "Icon" "Status_Burning"
data "AuraRadius" "10"
data "AuraStatuses" "IF(Item() and Tagged('KELAANVIL')):ApplyStatus(KELA_SMELTINGFORGE_STATUS_BURNING_1,100,-1)"

new entry "KELA_SMELTINGFORGE_STATUS_BURNING_1"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "KELA_SMELTINGFORGE_STATUS_BURNING_1"
data "DisplayName" "h59fbae8cg77fcg4470g90ebgbccc3281b962;1"
data "Description" "h36ac6733gf5c6g49f0g951egb382451cd049;1"
data "StatusPropertyFlags" "ForceOverhead"
data "Icon" "Item_TOOL_Smith_Anvil_B"

new entry "KELA_SMELTINGFORGE_STATUS_STAGE_2"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "KELA_SMELTINGFORGE_STATUS_STAGE_2"
data "DisplayName" "hefafb9b42596469eb82d599499b6dcd13a5f;1"
data "Description" "h2fc48659g0959g4b97g845agea24e7781a09;1"
data "StatusPropertyFlags" "DisableOverhead;IgnoreResting"
data "Icon" "Status_Burning"
data "AuraRadius" "10"
data "AuraStatuses" "IF(Character() and HasPassive('PassiveFeature_KelaBlacksmith')):ApplyStatus(KELA_CAN_POUR_METALBARS,100,-1);IF(Item() and Tagged('KELAANVIL')):ApplyStatus(KELA_SMELTINGFORGE_STATUS_BURNING_2,100,-1)"

new entry "KELA_SMELTINGFORGE_STATUS_BURNING_2"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "KELA_SMELTINGFORGE_STATUS_BURNING_2"
data "DisplayName" "h56d84ca229284863995c30350eaf4edf806d;1"
data "Description" "h36ac6733gf5c6g49f0g951egb382451cd049;1"
data "StatusPropertyFlags" "ForceOverhead"
data "Icon" "Item_TOOL_Smith_Anvil_B"

new entry "KELA_CAN_POUR_METALBARS"
type "StatusData"
data "StatusType" "BOOST"
// data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog"
data "DisplayName" "h1c1bc272995e4faa9d51366249c8257f4bb6;1"
data "Description" "he395c0e475be40388fb4e24b20fa0e7f9db5;1"
data "Icon" "Item_LOOT_GEN_Metalbar_Gold_A"
data "StackId" "KELA_CAN_POUR_METALBARS"

// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// Использование наставлений кузнеца
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------

new entry "BOOK_KELA_BLACKSMITH_APPRENTICE_USED"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "BOOK_KELA_BLACKSMITH_APPRENTICE_USED"
data "DisplayName" "h5f2a1497b44f4a6a98bf06f75b45d230756g;1"
data "Description" "h5d3e7c5633604727810ba54dc1b7cb36aec8;1"
data "StatusPropertyFlags" "ForceOverhead;DisablePortraitIndicator;IgnoreResting"
data "Passives" "PassiveFeature_KelaBlacksmith_Apprentice"
data "Boosts" "Tag(KELABLACKSMITHINGAPPRENTICE)"
data "RemoveConditions" "HasStatus('BOOK_KELA_BLACKSMITH_EXPERT_USED') or HasStatus('BOOK_KELA_BLACKSMITH_MASTER_USED')"
data "RemoveEvents" "OnStatusApplied"

new entry "BOOK_KELA_BLACKSMITH_EXPERT_USED"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "BOOK_KELA_BLACKSMITH_EXPERT_USED"
data "DisplayName" "h7663d9fabccb481e847c3128ddfb9fb97435;1"
data "Description" "h133df87dbf19474fafd684c1bca4c697gdb1;1"
data "StatusPropertyFlags" "ForceOverhead;DisablePortraitIndicator;IgnoreResting"
data "Passives" "PassiveFeature_KelaBlacksmith_Expert"
data "Boosts" "Tag(KELABLACKSMITHINGEXPERT)"
data "RemoveConditions" "HasStatus('BOOK_KELA_BLACKSMITH_MASTER_USED')"
data "RemoveEvents" "OnStatusApplied"

new entry "BOOK_KELA_BLACKSMITH_MASTER_USED"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "BOOK_KELA_BLACKSMITH_MASTER_USED"
data "DisplayName" "hc6d4a6e65c524d7bbe4161a0f1640c9b2d2c;1"
data "Description" "ha78400cc8c89413d9bdb7ff5d8207f1096a7;1"
data "StatusPropertyFlags" "ForceOverhead;DisablePortraitIndicator;IgnoreResting"
data "Passives" "PassiveFeature_KelaBlacksmith_Master"
data "Boosts" "Tag(KELABLACKSMITHINGMASTER)"

// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// Ковка нового оружия
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------

new entry "KELA_HANDMADE_WEAPON"
type "StatusData"
data "StatusType" "BOOST"
data "Icon" "Item_CONS_Potion_Sussur_Oil_A"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog;IgnoreResting"
data "OnApplyFunctors" "ApplyStatus(KELA_HANDMADE_WEAPON_FINISHED, 100, -1);ApplyStatus(KELA_HANDMADE_WEAPON_READY_FOR_TEMPERING, 100, 5)"
data "StackId" "KELA_HANDMADE_WEAPON"
data "RemoveEvents" "OnStatusApplied"
data "RemoveConditions" "HasStatus('KELA_HANDMADE_WEAPON_READY_FOR_TEMPERING')"

new entry "KELA_HANDMADE_WEAPON_READY_FOR_TEMPERING"
type "StatusData"
data "StatusType" "BOOST"
using "DIPPED_FIRE"
data "StackId" "KELA_HANDMADE_WEAPON_READY_FOR_TEMPERING"
data "Icon" "Action_DippedFire_Melee"
data "DisplayName" "h5097edda8d45401e942eb8e90c7872c42f69;1"
data "Description" "hf8abf007e62b43d9a76003eaeafa53e2130a;1"


new entry "KELA_HANDMADE_WEAPON_FINISHED"
type "StatusData"
data "StatusType" "BOOST"
// data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;IgnoreResting"
// data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog"
data "DisplayName" "ha7dcdd6fc1eb44eb97ca9daf3baaccb19815;1"
data "Description" "hb2c59f5bg830ag452bg936cgf18fd2c48b19;1"
data "Icon" "Tooltip_Weapon_Upgraded"
data "StackId" "KELA_HANDMADE_WEAPON_FINISHED"
data "Passives" "KELA_Handmade_Weapon_Passive"



new entry "KELA_BLACKSMITH_BUCKETOIL_USED"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "KELA_BLACKSMITH_BUCKETOIL_USED"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"
// data "StatusPropertyFlags" "ExecuteFunctorsOnOwner"
data "OnApplyFunctors" "ApplyEquipmentStatus(MainHand, KELA_HANDMADE_WEAPON_READY_FOR_FINISHING, 100, 10)"



new entry "KELA_HANDMADE_WEAPON_READY_FOR_FINISHING"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "KELA_HANDMADE_WEAPON_READY_FOR_FINISHING"
data "DisplayName" "hf9c4ebeca2b540e6bfd12a8cb7b356e1f1gc;1"
data "Description" "hf8abf007e62b43d9a76003eaeafa53e2130a;1"
data "OnApplyFunctors" "RemoveStatus(DIPPED_FIRE)"




